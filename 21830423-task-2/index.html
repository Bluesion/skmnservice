<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV ìë™ì™„ì„± ê²€ìƒ‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #f5f5f5;
            padding: 40px 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 30px;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 24px;
        }

        .search-container {
            position: relative;
            margin-bottom: 30px;
        }

        #searchInput {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s;
            background: transparent;
            position: relative;
            z-index: 2;
        }

        #searchInput:focus {
            border-color: #4CAF50;
        }

        .autocomplete-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            padding: 15px;
            border: 2px solid transparent;
            border-radius: 6px;
            font-size: 16px;
            color: #999;
            pointer-events: none;
            z-index: 1;
            background: white;
        }

        .autocomplete-hint {
            color: #ccc;
        }

        .results-container {
            border-top: 1px solid #eee;
            padding-top: 20px;
        }

        .results-title {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .results-list {
            list-style: none;
        }

        .results-list li {
            padding: 8px 12px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 3px solid #4CAF50;
            color: #333;
            font-size: 14px;
        }

        .no-results {
            color: #999;
            font-style: italic;
            text-align: center;
            padding: 20px;
        }

        .info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #1976d2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ì´ë¦„ ê²€ìƒ‰ ì‹œìŠ¤í…œ</h1>

        <div class="info">
            ğŸ’¡ ì´ë¦„ì„ ì…ë ¥í•˜ë©´ ìë™ì™„ì„±ê³¼ ê´€ë ¨ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </div>

        <div class="search-container">
            <div id="autocompleteOverlay" class="autocomplete-overlay"></div>
            <input
                type="text"
                id="searchInput"
                placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”..."
                autocomplete="off"
            >
        </div>

        <div class="results-container">
            <div class="results-title">ê²€ìƒ‰ ê²°ê³¼:</div>
            <ul id="resultsList" class="results-list">
                <li class="no-results">ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</li>
            </ul>
        </div>
    </div>

    <script>
        /**
         * ì´ë¦„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
         * - getNamesDataë¡œ í•¨ìˆ˜ ì´ë¦„ì„ ë³€ê²½í•˜ì—¬ ê°€ë…ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.
         * - toSorted() í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ì—¬ ì´ë¦„ì´ ì•ŒíŒŒë²³ ìˆœì„œëŒ€ë¡œ ì •ë ¬ë˜ë„ë¡ ê°œì„ í•˜ì˜€ìŠµë‹ˆë‹¤.
         * - ì¶”ê°€ ìš”ê±´ 3ì— ë§ê²Œ ë¡œì»¬ CSV íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ë„ë¡ ìˆ˜ì •í•˜ì˜€ìŠµë‹ˆë‹¤.
         * @param {string} filePath - CSV íŒŒì¼ ê²½ë¡œ (ê¸°ë³¸ ê²½ë¡œ: './assets/names.csv')
         * @returns {Promise<string[]>} ì´ë¦„ ë°°ì—´ì„ ë‹´ì€ Promise
         */
        function getNamesData(filePath = './assets/names.csv') {
            return new Promise((resolve, reject) => {
                fetch(filePath)
                    .then(response => {
                        if (!response.ok) {
                            // ì—ëŸ¬ ì²˜ë¦¬
                            // ì§€ê¸ˆì€ ë¡œì»¬ì—ì„œ CSV íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ê¸° ë•Œë¬¸ì— íŒŒì¼ ê²½ë¡œê°€ ì˜ëª»ë˜ì§€ ì•Šì•˜ëŠ”ì§€ ê¼­ í™•ì¸í•´ì£¼ì„¸ìš”.
                            console.error(`CSV íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: ${response.status} ${response.statusText}`);
                            return response.text().then(() => {
                                throw new Error(`HTTP ì—ëŸ¬ ìƒíƒœ: ${response.status}`);
                            });
                        }
                        return response.text();
                    })
                    .then(csvData => {
                        // CSV íŒŒì¼ì—ì„œ ì´ë¦„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ ì‚¬ì „ìˆœìœ¼ë¡œ ì •ë ¬í•©ë‹ˆë‹¤.
                        const names = csvData.split(',').map(name => name.trim()).filter(name => name.length > 0);
                        resolve(names.toSorted());
                    })
                    .catch(error => {
                        console.error("CSV íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì˜€ìŠµë‹ˆë‹¤:", error);
                        reject(error);
                    });
            });
        }

        /**
         * ìœ ì €ê°€ ì…ë ¥í•œ ê²€ìƒ‰ì–´ì— ëŒ€í•´ ë§¤ì¹­ë˜ëŠ” ì´ë¦„ ë°°ì—´ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
         * - findMatchingNamesë¡œ í•¨ìˆ˜ ì´ë¦„ì„ ë³€ê²½í•˜ì—¬ ê°€ë…ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.
         * @param {string[]} nameList - ê²€ìƒ‰ì„ ìˆ˜í–‰í•  ì´ë¦„ ë°°ì—´
         * @param {string} query - ìœ ì €ê°€ ì…ë ¥í•œ ê²€ìƒ‰ì–´
         * @returns {string[]} ê²€ìƒ‰ì–´ì™€ ë§¤ì¹­ëœ ì´ë¦„ ë°°ì—´
         */
        function findMatchingNames(nameList, query) {
            if (!query.trim()) {
                return [];
            }

            return nameList.filter(name =>
                name.toLowerCase().includes(query.toLowerCase())
            );
        }

        /**
         * ìœ ì €ê°€ ì…ë ¥í•œ ê²€ìƒ‰ì–´ë¡œ ì‹œì‘í•˜ëŠ” ì´ë¦„ì„ ìë™ì™„ì„± íŒíŠ¸ë¡œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
         * - findAutocompleteHintë¡œ í•¨ìˆ˜ ì´ë¦„ì„ ë³€ê²½í•˜ì—¬ ê°€ë…ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.
         * @param {string[]} nameList - ê²€ìƒ‰ì„ ìˆ˜í–‰í•  ì´ë¦„ ë°°ì—´
         * @param {string} query - ìœ ì €ê°€ ì…ë ¥í•œ ê²€ìƒ‰ì–´
         * @returns {string|null} ê²€ìƒ‰ì–´ì™€ ë§¤ì¹­ëœ ì´ë¦„
         */
        function findAutocompleteHint(nameList, query) {
            if (!query.trim()) {
                return null;
            }

            const match = nameList.find(name =>
                name.toLowerCase().startsWith(query.toLowerCase())
            );

            return match || null;
        }

        /**
         * ìœ ì €ê°€ ì…ë ¥í•œ ê²€ìƒ‰ì–´ì— ëŒ€í•´ ê²€ìƒ‰ ê²°ê³¼ ë¦¬ìŠ¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
         * - ê²€ìƒ‰ ê²°ê³¼ ì²˜ë¦¬ í•¨ìˆ˜ì™€ ìë™ì™„ì„± ì²˜ë¦¬ í•¨ìˆ˜ì„ ë¶„ë¦¬í•˜ì—¬ ê°€ë…ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.
         * - ë¶ˆí•„ìš”í•œ í•¨ìˆ˜ê°€ ë°˜ë³µë˜ëŠ” ì½”ë“œë¥¼ ì‚­ì œí•˜ì—¬ ì„±ëŠ¥ì„ í–¥ìƒí•˜ì˜€ìŠµë‹ˆë‹¤.
         * @param {HTMLElement} listElement - UIê°€ ê°±ì‹ ë˜ëŠ” íƒœê·¸
         * @param {string[]} matches - ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê²€ìƒ‰ì–´ì™€ ë§¤ì¹­ë˜ëŠ” ì´ë¦„ ë°°ì—´
         * @param {string} query - ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê²€ìƒ‰ì–´
         */
        function updateResultsList(listElement, matches, query) {
            // ê¸°ì¡´ì˜ removeChild() í•¨ìˆ˜ë¡œ UIë¥¼ ì´ˆê¸°í™” í•˜ëŠ” ëŒ€ì‹ , ê³µë°± ì½”ë“œë¡œ UIë¥¼ ì´ˆê¸°í™” í•©ë‹ˆë‹¤.
            listElement.innerHTML = '';

            if (matches.length === 0) {
                const message = query.trim() ? 'ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤' : 'ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”';
                listElement.innerHTML = `<li class="no-results">${message}</li>`;
            } else {
                matches.forEach(name => {
                    const li = document.createElement('li');
                    li.textContent = name;
                    listElement.appendChild(li);
                });
            }
        }

        /**
         * ìë™ì™„ì„± íŒíŠ¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
         * - ê²€ìƒ‰ ê²°ê³¼ ì²˜ë¦¬ í•¨ìˆ˜ì™€ ìë™ì™„ì„± ì²˜ë¦¬ í•¨ìˆ˜ì„ ë¶„ë¦¬í•˜ì—¬ ê°€ë…ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.
         * - ë¶ˆí•„ìš”í•œ í•¨ìˆ˜ê°€ ë°˜ë³µë˜ëŠ” ì½”ë“œë¥¼ ì‚­ì œí•˜ì—¬ ì„±ëŠ¥ì„ í–¥ìƒí•˜ì˜€ìŠµë‹ˆë‹¤.
         * - ì˜ˆì‹œ) ìœ ì €ê°€ Alì„ ì…ë ¥ ì‹œ, __exander í…ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´ë¥¼ ë§ì”Œì›Œ ìë™ì™„ì„± íŒíŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
         * @param {HTMLElement} overlayElement - ìë™ì™„ì„± ì˜¤ë²„ë ˆì´ íƒœê·¸
         * @param {string|null} hint - ì „ì²´ íŒíŠ¸
         * @param {string} query - ì „ì²´ íŒíŠ¸ ì¤‘ ìœ ì €ê°€ ì…ë ¥í•œ ë¶€ë¶„
         */
        function updateAutocomplete(overlayElement, hint, query) {
            // ê¸°ì¡´ íŒíŠ¸ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
            overlayElement.innerHTML = '';

            if (hint && query.length > 0) {
                // ìœ ì €ê°€ ì…ë ¥í•œ í…ìŠ¤íŠ¸ì™€ ë™ì¼í•œ ê¸¸ì´ì˜ í…ìŠ¤íŠ¸ë¥¼ íˆ¬ëª…í•˜ê²Œ ë§Œë“¤ì–´ ìë™ì™„ì„± íŒíŠ¸ì˜ ê³µë°±ì„ ì¡°ì •í•©ë‹ˆë‹¤.
                const typedPart = document.createElement('span');
                typedPart.style.color = 'transparent';
                typedPart.textContent = query;

                // ë‚˜ë¨¸ì§€ ìë™ì™„ì„± íŒíŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
                const hintPart = document.createElement('span');
                hintPart.className = 'autocomplete-hint';
                hintPart.textContent = hint.slice(query.length);

                overlayElement.appendChild(typedPart);
                overlayElement.appendChild(hintPart);
            }
        }

        // ì½”ë“œë¥¼ ë¶„ë¦¬í•˜ê³  í•¨ìˆ˜í™”í•˜ì—¬ ê°€ë…ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.
        // ë³€ìˆ˜ ì´ë¦„ì„ ì§ê´€ì ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ ê°€ë…ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.
        // ì¤‘ë³µ í•¨ìˆ˜ í˜¸ì¶œì„ ì œê±°í•˜ì—¬ ì„±ëŠ¥ì„ ê°œì„ í•˜ì˜€ìŠµë‹ˆë‹¤.
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('searchInput');
            const resultsList = document.getElementById('resultsList');
            const autocompleteOverlay = document.getElementById('autocompleteOverlay');

            // ì¶”ê°€ ìš”ê±´ 3ì— ë”°ë¼ ë¡œì»¬ CSV íŒŒì¼ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
            getNamesData()
                .then(names => {
                    if (names.length === 0) {
                        console.error("ì´ë¦„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. íŒŒì¼ ìì²´ì— ë¬¸ì œê°€ ìˆì§€ ì•Šì€ì§€, íŒŒì¼ ê²½ë¡œì— ë¬¸ì œê°€ ìˆì§€ ì•Šì€ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.");
                        resultsList.innerHTML = '<li class="no-results">ì´ë¦„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</li>';
                        searchInput.disabled = true; // ë°ì´í„° ë¡œë”© ì¤‘ ì˜¤ë¥˜ ë°œìƒì‹œ ê²€ìƒ‰ì°½ ë¹„í™œì„±í™”
                        return;
                    }

                    function handleSearchInput() {
                        const query = searchInput.value;

                        const matchingNames = findMatchingNames(names, query);
                        const hint = findAutocompleteHint(names, query);

                        updateResultsList(resultsList, matchingNames, query);
                        updateAutocomplete(autocompleteOverlay, hint, query);
                    }

                    searchInput.addEventListener('input', handleSearchInput);

                    console.log('ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    console.log(`ì´ ${names.length}ê°œì˜ ì´ë¦„ì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.`);
                })
                .catch(error => {
                    console.error("CSV ë°ì´í„° ë¡œë”© ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
                    resultsList.innerHTML = '<li class="no-results">ë°ì´í„° ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. CSV íŒŒì¼ê³¼ ê²½ë¡œë¥¼ ë‹¤ì‹œ í•œ ë²ˆ í™•ì¸í•´ì£¼ì‹œê³ , CORS ì˜¤ë¥˜ê°€ ë°œìƒí•œ ê²½ìš° live-serverë¥¼ í†µí•´ ì‹¤í–‰í•´ì£¼ì„¸ìš”.</li>';
                    searchInput.disabled = true; // ë°ì´í„° ë¡œë”© ì¤‘ ì˜¤ë¥˜ ë°œìƒì‹œ ê²€ìƒ‰ì°½ ë¹„í™œì„±í™”
                });
        });
    </script>
</body>
</html>